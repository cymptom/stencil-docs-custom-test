const fs = require('fs');
const packageJson = require('../package.json');
const path = require('path');

const addedDocs = {
	name: 'my-design-system',
	version: packageJson.version
};

/** @typedef {import('@stencil/core/internal').OutputTargetDocsCustom['generator']} Generator */

/**
 * Returns the docs generator function, which takes in the {@link JsonDocs} generated by Stencil,
 * makes any necessary additions or modifications, and writes the docs file to disk.
 * @param {string} dest
 * @returns {Generator}
 */
const getDocsGenerator = (dest) => {
	return (docs) => {
		const modifiedDocs = {
			...addedDocs,
			...docs
		};

		const data = JSON.stringify(modifiedDocs);
        fs.writeFileSync(
            path.resolve(__dirname, dest), 
            data
        );
	};
};

module.exports = { getDocsGenerator };